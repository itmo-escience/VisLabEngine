### Список задач по редактору интерфейсов
- [x] Отображение якорей: индикация активных и расстояние до родителя
- [x] Назначение якорей кликом ПКМ на индикаторах
- [x] Перемещение и растяжение фрейма при помощи мыши 
- [x] Перемещение фрейма при помощи клавиватуры
- [x] Переизмерения фрейма при помощи клавиватуры
- [ ] Переключение между фреймами при помощи Tab
- Визуальное дерево элементов на экране 
  - [x] Отображение дерева элементов
  - [x] Удаление элемента при нажатии клавиши "Delete"
  - [x] Отображение имени фрейма, а не его текста
  - [x] Раскрытие дерева до выбранного мышью элемента
  - [x] Drag'n'drop!!!!
  - [ ] Мультивыделение элементов (Shift/Ctrl)
- Палитра фреймов, доспутных для импортирования из *.xml файлов
  - [x] Формирование списка шаблонов из доступных файлов
  - [x] Drag'n'drop для создания
- [x] Мышь: выбор фрейма при клике  
- Создание новой пустой сцены
  - [x] Кнопка в тулбаре
  - [x] Ctrl+N (New Scene)
  - [x] Проверка, если есть несохраненные изменения в сцене
- Save/Load : сделать кнопки и протестировать  
  - [x] Save/Load выбранного фрема в качестве шаблона
  - [x] Save/Load текущей "сцены"
  - [x] Сдеать кнопки для Save/Load
  - [x] Проверка на наличие папки для шаблонов 
  - [x] Quick save
  - [x] Crtl+S keybinding
  - [x] Ctrl+Shift+S keybinding
  - [x] Ctrl+O (Open Scene) - Load scene
  - [x] Disable "Quick Save" when not possible
  - [x] Проверка, если есть несохраненные изменения в сцене 
    - [x] при загрузке
    - [x] при закрытии окна
  - [x] CommandManager.IsDirty {get;}
  - [x] void CommandManager.SetNotDirty()  
  - [x] Ctrl+C/Ctrl+V для выбранного фрейма
  - [x] Ctrl+C/Ctrl+V для выбранной группы фреймов
  - [ ] Создание копии фрейма при зажатии Ctrl и отпускании мыши при перемещении фрейма
  - [ ] Создание рядом копии фрейма при нажатии Ctrl+D
  - [x] Ctrl+X
  - [x] "Копирование" в буфер обмена xml-кода фрейма(?)
  - [x] "Копирование" в буфер обмена изображения фрейма(?) для вставки между окнами/вкладками(?) редактора интерфейсов
- [x] Имя файла со сценой в заголовке окна, звездочка после имени если есть несохраненные изменения (New scene* если еще ни разу не сохраняли сцену)
- Назначение детей (drag'n'drop)
  - [x] Для обычных Frame'ов
  - [x] Рамка для потенциального родителя при перемещении Frame'а
- [x] DUMMY devices для Fusion (мышь, клавиатура и пр.)
- Размеры и положение
  - [x] Отображение на подсветке (на панели) информации о позиции во время перетаскивания
  - [x] Отображение на подсветке (на панели) информации о размерах во время переизмерения (drag'а)
  - [x] Отображение текущих размеров сцены на тулбаре или где-то в углу
  - [x] Режим отображение сетки с регулируемым шагом (по умолчанию 5 unit)
  - Прилипания
    - [x] Не прилипать при зажатом Alt
    - [x] К границам уже существующих фреймов того же родителя при перетаскивании
    - [x] К границам уже существующих фреймов того же родителя при переизмерении
    - [x] Серединами с существующими фреймами того же родителя
    - [x] К границам сцены    
    - [x] К сетке
  - [x] Сохранять начальное (до начала перезимерения) соотношение сторон при зажатом Shift
  - [x] Перемещение по осям при зажатом Shift
  - [x] Переизмерение с масштабированием относительно центра фрейма с использованием ctrl
  - [x] 
- [x] Автоматическая генерация имени фрейма
- [x] Группировка фреймов
  - [x] Перизмерение масштабное с перемещением (как у группы в PowerPoint)
- [x] Мультивыделение фреймов
  - [x] Добавлять к выделению при помощи Shift
  - [x] Добавлять к выделению при помощи "рамочки"
  - [x] Выравнивания влево/вправо/вверх/вниз/в центре/по горизонтали/по вертикали
  - [x] Свой frameSelectionPanel для каждого фрейма
  - [x] Перизмерение масштабное с сохранением пропорций каждого фрейма (как в PowerPoint)
  - [x] применение масштабирования к группе фреймов так, будто они являются дочерними элементами со всеми якорями и по тем же принципам, что и одиночные фреймы
  - [x] Снимать выделение фреймов по Esc
- Панели инструментов  
  - [x] Делать невидимыми при нажатии на крестик, показывать при нажатии на кнопку на тулбаре
- Реализовать команды для Do/Undo
  - [x] Список базовых команд
  - [x] Реализация базовых команд
  - [x] Композиция команд (группа команд лежит в одной команде)
  - [x] Реализация стека команд 
  - [x] Ctrl+Z/Ctrl+Y keybindings
  - [x] Disable buttons when action is not possible
- [x] Tooltip для всех кнопок в панели меню
- [x] Слой в WPF для отрисовки выделения фреймов
- [ ] Переписать слой выделения рамками с использованием Interface
- [x] Создать вкладки, отображающие сцены
- [x] Реорганизовать менюшку
- [ ] Отдельное окно редактирование фрейма для детализированного создания фрейма-шаблона
- [x] Добавить возможность зума (ZoomIn/ZoomOut) для pixel perfect настройки
  - [x] Добавить диалогое окно настройки размера сцены
  - [x] Сохранять в конфиг стандартный размер новой сцены
  - [x] Сохранять размеры сцены
  - [x] Сделать фон главного окна серым
  - [x] Отображение позиции мыши
  - [x] Центрировать область отрисовки
  - [ ] Зумить к позиции мыши, зумить обратно к центру
- [ ] Рисование шаблона рамкой (задание изначального размера)(?)
- [x] Interface для приведения любого customInterface'а и доставания общих и необходимых данных
Данные конфигурации системы
- [x] Не сохраняется выбранный шаг сетки при перезапуске
- [x] Запоминать положение панелей инструментов при закрытии и восстанавливать при открытии
- [x] Запоминать размер панелей инструментов при закрытии
- [x] Запоминать размер и положение главного окна при закрытии и восстанавливать при открытии
- Контроллеры
  - [x] Отображение свойств в разных состояниях
  - [x] Изменение значений свойств
  - [x] Добавление и удаление свойств
- Вкладки  
  - [x] Открытие нескольких сцен и переключение между вкладками
  - [x] Обработка сохранения при закрытии
  - [ ] Закрывать вкладку по Ctrl+W
- Прикрепление к проектам
  - [ ] Запоминать последний открытый проект  
  - [x] Добавить путь к директории со сценами в ICustomazableUI и предлагать по умолчанию при сохранениии/загрузке сцены.(сохраняется в файле конфигурации)
---
### DirectD2D
- Очиста базового класса Frame от лишних "сущностей"
	- [x] Избавиться от FrameProcessor
	- [x] Избавиться от Game
- [ ] Вынос дальнейшей логики в контроллеры (Scalable, Free и пр) 
- [ ] Список фреймов, требуемых для переноса и требуется шаблонизировать
- [ ] Оформить внутреннюю документацию с помощью XML-комментариев (для базового фрейма)
- [ ] Frame с shape'ом (SVG)(?)
- [ ] Смерджить изменения редактора с рабочими файлами (для возможности создания новых проектов и редактирования старых)
- Привести код в приличное состояние
  - [ ] Zero warnings policy - в коде редактора не должно быть warning'ов
  - [ ] Очистить ненужные комментарии
- Переделываем ZOrder
  - [x] Bring to front, Send to back, Bring forward, Send backward
  - [x] Add at front, Add at back
  - [x] Add in front of
- Перерисовка только измененнных областей
- Компоненты
  - [x] Изображение
  - [ ] RenderTarget
  - [ ] Кривые безье
  - [ ] Формы
  - Label
    - [ ] Размеры и виды шрифтов
    - [ ] ResizeToContent
    - [ ] TextAlignment
    - [ ] ForegroungColor
  - Простые графики
- Контроллеры
  - [ ] Десериализация  
  - Состояния
    - [ ] Инициализация состояния
    - [ ] Состояния по умолчанию
    - [ ] Отслеживание изменение значений свойств текущего состояния
  - Стили
    - [ ] Создание компонента с определенным стилем
    - [ ] Стиль по умолчанию
  - Типы контроллеров
    - [ ] Button
    - [ ] TextBox
      - [ ] Редактирование
      - [ ] Перемещение курсора
      - [ ] Выделение
      - [ ] Копирование/вставка
    - [ ] Popup
    - [ ] CheckBox
    - [ ] RadioBox
    - [ ] Slider
    - [ ] Dropdown
    - [ ] Progressbar
    - [ ] Timeline
    - [ ] NumericBox
    - [ ] Compass
    - [ ] Scrollable
    - [ ] Tabs    
---
### Светлое будущее
- [ ] Глобальный бэкграунд
- Область работы со свойствами 
  - [ ] shadowOffset
  - [x] imageName  
  - [ ] Поиск по имени свойств
  - [ ] Сортировка по имени свойств
  - [ ] Логическая группировка свойств элемента в редакторе свойств
  - [ ] Назначение нескольким элементам значение общенго параметра одновременно
- [ ] "Замочек" для защиты от изменения атрибутов конкретного фрейма
  - [ ] Замочек ставится рекурсивно на фрейм-контейнер
- [ ] "Призрак" фрейма при перетаскивании из палитры (или превьюшка в небольшом окне)
- [ ] Сгенерировать стандартные фреймы с "default'ными" значениями
- [x] При переходе через ноль во время изменения размеров фрейма начинать менять противоположную границу (тянули за лево, при переходе через 0 стали тянуть за правую границу, см. PowerPoint)  
- [ ] padding, margin свойства UIComponent
- [ ] pivot (для трансформации)

---
### Планы на недельку
- Допочинить повернутые фреймы
- Интерфейс для присоединения редактора к приложению
- Десериализовать фреймы в приложении
- Сделать изменение детей потокобезопасным (развесить мониторы в правильных местах)
  - _engine.RunExternal(tokenSource.Token) вызывает изменение коллекции детей во время слушания событий мыши(?)
- Доделать контроллеры
  - Метод "модифицировать стейт": выставить указаному проперти указанное значение через рефлекшн
  - Метод "перейти на стейт": применить все свойства для пропертей, которое записано
  - Обеспечить генерацию уникального имени для контроллера
  - Отобразить фрейм-холдер контроллера в редакторе особенно:
    - Вместо него отобразить тип контроллера
	- В качестве детей публичные проперти, которые возвращаюит UIComponent (или завести атрибут, или еще как-то)
	- Фреймы в публичных пропертях можно *только* заменять
  -	Доделать ButtonController
  - Сделать ToggleController
  - Попробовать сделать RadioButtonController
  
---
### Известные баги
- [x] Мерцание глобуса на фоне
  - Двойная буферизация не помогает
  - Не связано с неправильной обработкой IsFrontBufferAvailableChanged
- [x] Падение при клике на выбранный фрейм при его положении за пределами родителя
- [x] Не скрываются линии якоря во время перетаскивания
- [x] При перетаскивании из палитры потенциальный родитель не подсвечен
- [x] Не удаляется фрейм после выделения в treeview 
- [x] При добавлении фрейма глубже 2 уровня неправильный рассчет позиции
- [x] При клике ПКМ во время перетаскивания все ломается
- [x] Рамка выделения и якоря должны быть над полосатостью потенциального родителя
- [x] Задержка после начала перетаскивания
- [x] Дрожание панелей инструментов при перетаскивании. Может долго перерисовывается контент?
- [x] Сброс выделения фрейма при откате команды его создания из палитры шаблонов
- [x] Некорректное положение при вложении фрейма в родителя из шаблона
- [x] при быстром клике иногда не срабатывает событие MouseUp
- [x] Реализовать вызов команд без их записи в стек
- [x] Исправить палитру (сделать drag'n'drop, а сейчас клик в палитру и клик в сцену)
- [x] Дублировать хоткеи на парные кнопки
- [x] Перевести keyDown события на keyBinding
- [x] При нажатии alt при перемещении перестает отображать перемещение
- [x] Именование field & property не соответствует модификаторам доступа
- [x] Перенести switch по дрэгам во FrameSelectionPanel и сделать в виде словаря или поименовать константы + сделать соответствующие поля приватными
- [x] Перевести мультивыделение с индивидуальных панелек на групповую панельку 
- [x] Исправить поведение при переизмерении с Shift не при помощи угловых кнопок
- [x] Программа закрывается после отмены сохранения измененной сцены
- [x] В палитре не выделяется текущий добавляемый шаблон 
- [x] Запретить выделение дочерних и родительских фреймов через shift
- [x] Размер сцены не отображается сразу при загрузке
- [x] Фрейм невозможно перемещать при помощи кнопок (кнопки перехватываются ScrollView)
- [x] При выделении рамкой и при выходе мыши за пределы окна приложения отслеживать мышь для создания корректной зоны выделения
- [x] При выделении рамкой и перемещении за пределы окна приложения, скроллить сцену при необходимости
- [x] При близких разных прилипаниях показывать "реальное" прилипание
- [x] Прилипания при переизмерении при помощи shift должны работать по границам фреймов, а не по позиции мыши ?
- [x] Клиппинг BoundingBox-a при клиппинге контейнера.
- [x] Имя фрейма не проверяется на уникальность при выставлении в окне свойств.
- [x] После изменения размера сцены прекращается ее отрисовка.
- [x] Относительный путь для картинки.
- [x] Отключать прилипание при зажатом Alt.
- [x] При попытке поменять размер сцены при переключениях между вкладками периодически изображение виснет
- [x] Окно консоли
  - [x] Высота окна ограничена сверху.
  - [x] Нет возможности копировать текст.
  - [x] help не выводит полный список команд (решено: есть listCmds).
  - [x] Консоль не пролистывается при выводе текста.
  - [x] Возврат к старой команде через клавиши со стрелками.
  - [x] Необходимо запоминать уровень сообщений для вывода при завершении работы.
- [x] В диалаоговом окне переизмерения сцены добавить Enter и Esc для срабатывания "ОК" и "Отмена" соответственно
- [x] При сохранении новой сцены в файл имя вкладки не меняется (дожно обновляться как в заголовке окна редактора)
- [x] Задизейблить кнопку "File"->"Save template", если нет выделенных элементов
- [x] Сделать центром Zoom'а положение мыши на сцене
- [x] Для каждой сцены хранить свой стек команд Undo/Redo (некорректная работа при переключении между сценами)
- [x] Курсор сбрасывается в окне деталей компонента
- [x] Исправить индикатор "грязи" при выполнении команд через Undo/Redo
- [x] Переизмернеие повернутого фрейма
  - [x] Учитывать поворот при переизмерении 
  - [ ] Переизмерение группы, в которых разные фреймы повернуты по разному (решено отложить)
- [ ] починить treeview:
    - [ ] нет автоматического выделения добавленных элементов
    - [ ] При добавлении в пустой контейнер при помощи перетаскивания из палитры дублируется запись в treeview
- [ ] GlobalAngle у компонента считается неверно.
- [ ] Найти все возможные утечки памяти (dispose)
- [ ] При бросании фрейма из повернутого контейнера в повернутый контейнер, он сползает. (решено отложить)
- [ ] Прилипание к фреймам сделать по BoundingBox.
- [ ] Прокидывание горячих клавиш из опциональных окон в главное (решено отложить)
- [ ] Контроллеры
  - [ ] Отсутствие контроля z-order-а у слотов.
  - [ ] Отсутствие возможности делать switch по состояниям.
  - [ ] Настроить сериализацию и десериализацию
  - [ ] Определиться с системой добавления элементов в слоты при помощи перетаскивания мышью
  - [ ] Реализовать корректную работу слотов: добавление в слот и удаление из слота, перезапись слота
- [ ] Прозрачность изображений работает некорректно.
- [ ] Падение при закрытии редактора.
- [ ] Назначить всем необходимым свойствам NotifyPropertyChanged

- [ ] При полном откате стека изменений сцена все еще считается "грязной"(?)

- [ ] Запретить выбор детей текущего выбранного элемента при одиночном клике без Shift'а (ожидается перемещение элемента, а вместо него перемещается ребенок)
- [ ] Скрыть ненужные свойства в окне свойств компонента и определить корректное отображение для нестандартных структур
- [ ] При прилипании не отображает все действительные линии, а только лишь первые три по каждой оси

- [x] Сброс каретки при изменении текстовых полей (именование элементов и изменение параметров)
- [x] Нет прокрутки дерева элементов при помощи мыши (Adorner перехватывает мышь)
- [x] Отловить падение в TreeView
- [ ] Дублирование в дереве элементов первого непосредственно брошенного на контейнер элемента (вводит в заблуждение) (решено отложить)
- [ ] Начинает тормозить при большом количестве элементов на экране (Edit-режим отрисовки границ всех компонентов)
- [ ] Невозможность выделить рамкой дочерние элементы контейнера (выбирается и мгновенно перетаскивается контейнер) (?) (отложить до обсуждения слотов)
- [ ] Realizovat' konteiner s yakoryami
